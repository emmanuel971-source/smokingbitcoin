<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bitcoin vs Cigarettes Calculator</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
    <style>
        body {
            background-color: #f8f9fa;
            font-family: 'Arial', sans-serif;
        }
        .header {
            background: linear-gradient(90deg, #198754, #28a745);
            color: white;
            padding: 20px;
            text-align: center;
            border-bottom: 4px solid #ffc107;
        }
        .header h1 {
            font-size: 2.8rem;
            font-weight: bold;
            margin: 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
        }
        .header h2 {
            font-size: 1.4rem;
            font-style: italic;
            margin-top: 8px;
        }
        .icon {
            margin-right: 8px;
            font-size: 2.3rem;
            vertical-align: middle;
        }
        .container {
            max-width: 800px;
            margin: 20px auto;
            padding: 15px;
            background: white;
            border-radius: 10px;
            box-shadow: 0 0 15px rgba(0,0,0,0.1);
        }
        .form-label {
            font-weight: bold;
            color: #198754;
        }
        .btn-calculate {
            background-color: #198754;
            border: none;
            width: 100%;
            transition: background-color 0.3s;
        }
        .btn-calculate:hover {
            background-color: #146c43;
        }
        .btn-share {
            background-color: #17a2b8;
            border: none;
            transition: transform 0.2s;
        }
        .btn-share:hover {
            transform: scale(1.05);
        }
        #result {
            margin-top: 25px;
            text-align: center;
        }
        .result-value {
            font-size: 1.7rem;
            font-weight: bold;
            color: #198754;
        }
        .million {
            font-size: 2.1rem;
            color: #ffc107;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }
        .motivation {
            margin-top: 15px;
            font-size: 1.1rem;
            font-style: italic;
            color: #dc3545;
            font-weight: bold;
        }
        .disclaimer {
            font-size: 0.8rem;
            color: #6c757d;
            margin-top: 15px;
            line-height: 1.4;
        }
        canvas {
            max-width: 100%;
            height: auto !important;
        }
        .loader {
            display: none;
            text-align: center;
            margin: 20px;
        }
        @media (max-width: 576px) {
            .header h1 {
                font-size: 1.8rem;
            }
            .header h2 {
                font-size: 1.1rem;
            }
            .icon {
                font-size: 1.8rem;
            }
            .container {
                padding: 10px;
            }
            .result-value {
                font-size: 1.4rem;
            }
            .million {
                font-size: 1.7rem;
            }
        }
    </style>
</head>
<body>
    <div class="header">
        <h2 id="hook">Can Bitcoin save your life and finances?</h2>
        <h1><i class="fas fa-lungs icon"></i><i class="fab fa-bitcoin icon"></i> <span id="title">Save your money and health</span></h1>
    </div>
    
    <div class="container">
        <form id="calcForm" aria-label="Calculateur cigarettes vs Bitcoin">
            <div class="mb-3">
                <label for="brand" class="form-label" id="brandLabel">Cigarette brand</label>
                <select class="form-select" id="brand" aria-describedby="brandHelp">
                    <option value="average">Average</option>
                    <option value="marlboro">Marlboro</option>
                    <option value="camel">Camel</option>
                    <option value="gauloises">Gauloises (or similar)</option>
                </select>
                <small id="brandHelp" class="form-text text-muted">Select your cigarette brand</small>
            </div>
            
            <div class="mb-3">
                <label for="cigsPerDay" class="form-label" id="cigsLabel">Cigarettes per day</label>
                <input type="number" class="form-control" id="cigsPerDay" min="1" value="20" aria-describedby="cigsHelp">
                <small id="cigsHelp" class="form-text text-muted">Enter daily cigarette consumption</small>
            </div>
            
            <div class="mb-3">
                <label for="startYear" class="form-label" id="yearLabel">Start year</label>
                <input type="number" class="form-control" id="startYear" min="2009" max="2025" value="2009" aria-describedby="yearHelp">
                <small id="yearHelp" class="form-text text-muted">Enter the year you started</small>
            </div>
            
            <button type="button" class="btn btn-primary btn-calculate" onclick="calculate()" id="calcButton"><i class="fas fa-calculator"></i> Calculate</button>
        </form>
        
        <div class="loader" id="loader">
            <i class="fas fa-spinner fa-spin"></i> Calculating...
        </div>
        
        <div id="result" style="display: none;" role="region" aria-live="polite">
            <h3 id="resultsTitle">Results</h3>
            <p id="spentText">Total spent on cigarettes: <span id="totalSpent" class="result-value"></span> USD</p>
            <p id="btcText">BTC accumulated: <span id="totalBtc" class="result-value"></span> BTC</p>
            <p id="valueText">Current value: <span id="currentValue" class="result-value"></span> USD</p>
            <p id="gainText">Net gain: <span id="gain" class="result-value"></span> USD</p>
            
            <canvas id="evolutionChart" class="mt-4"></canvas>
            
            <p class="motivation" id="motivation">Imagine what you could do with that money! Quit smoking today for a healthier, richer life.</p>
            <button class="btn btn-share mt-2" onclick="shareOnX()" id="shareButton"><i class="fab fa-x-twitter"></i> Share on X</button>
            <p class="disclaimer" id="disclaimer">Disclaimer: Simulation based on historical data (WHO, Statista, CoinGecko). BTC investments are risky; past performance does not guarantee future results. Consult a professional.</p>
        </div>
    </div>
    
    <footer class="text-center mt-4" style="font-size: 0.8rem; color: #6c757d;">
        <p>Sources: <a href="https://apps.who.int/gho/data/view.main.TOBRETAILv">WHO Tobacco Prices</a>, <a href="https://www.statista.com/statistics/415034/cigarette-prices-across-europe/">Statista</a>, <a href="https://www.numbeo.com/cost-of-living/">Numbeo</a>, <a href="https://www.coingecko.com/en/coins/bitcoin/historical_data">CoinGecko BTC Data</a>, Euromonitor Reports. Prices in USD, 2009-2025, with linear interpolation for missing years.</p>
    </footer>
    
    <script>
        // Traductions
        const translations = {
            fr: { hook: "Bitcoin peut-il sauver votre vie et vos finances ?", title: "Sauvez votre argent et votre santé", brandLabel: "Marque de cigarettes", cigsLabel: "Nombre de cigarettes par jour", yearLabel: "Année de début", calcButton: "Calculer", resultsTitle: "Résultats", spentText: "Total dépensé en cigarettes", btcText: "BTC accumulé", valueText: "Valeur actuelle", gainText: "Gain net", motivation: "Imaginez ce que vous pourriez faire avec cet argent ! Arrêtez de fumer aujourd'hui pour une vie plus saine et plus riche.", shareButton: "Partager sur X", disclaimer: "Disclaimer : Simulation basée sur données historiques (OMS, Statista, CoinGecko). Les investissements en Bitcoin sont risqués, les performances passées ne garantissent pas les résultats futurs. Consultez un professionnel." },
            en: { hook: "Can Bitcoin save your life and finances?", title: "Save your money and health", brandLabel: "Cigarette brand", cigsLabel: "Cigarettes per day", yearLabel: "Start year", calcButton: "Calculate", resultsTitle: "Results", spentText: "Total spent on cigarettes", btcText: "BTC accumulated", valueText: "Current value", gainText: "Net gain", motivation: "Imagine what you could do with that money! Quit smoking today for a healthier, richer life.", shareButton: "Share on X", disclaimer: "Disclaimer: Simulation based on historical data (WHO, Statista, CoinGecko). BTC investments are risky; past performance does not guarantee future results. Consult a professional." },
            es: { hook: "¿Puede Bitcoin salvar tu vida y tus finanzas?", title: "Salva tu dinero y tu salud", brandLabel: "Marca de cigarrillos", cigsLabel: "Cigarrillos por día", yearLabel: "Año de inicio", calcButton: "Calcular", resultsTitle: "Resultados", spentText: "Total gastado en cigarrillos", btcText: "BTC acumulado", valueText: "Valor actual", gainText: "Ganancia neta", motivation: "¡Imagina lo que podrías hacer con ese dinero! Deja de fumar hoy para una vida más sana y rica.", shareButton: "Compartir en X", disclaimer: "Descargo: Simulación basada en datos históricos (OMS, Statista, CoinGecko). Inversiones en BTC arriesgadas; el rendimiento pasado no garantiza resultados futuros. Consulta a un profesional." },
            ru: { hook: "Может ли Bitcoin спасти вашу жизнь и финансы?", title: "Сохраните свои деньги и здоровье", brandLabel: "Марка сигарет", cigsLabel: "Сигарет в день", yearLabel: "Год начала", calcButton: "Рассчитать", resultsTitle: "Результаты", spentText: "Всего потрачено на сигареты", btcText: "Накопленный BTC", valueText: "Текущая стоимость", gainText: "Чистая прибыль", motivation: "Представьте, что вы могли бы сделать с этими деньгами! Бросьте курить сегодня для более здоровой и богатой жизни.", shareButton: "Поделиться в X", disclaimer: "Отказ от ответственности: Симуляция на основе исторических данных (ВОЗ, Statista, CoinGecko). Инвестиции в BTC рискованны, прошлые результаты не гарантируют будущих. Обратитесь к профессионалу." },
            zh: { hook: "比特币能拯救你的生命和财务吗？", title: "拯救你的金钱和健康", brandLabel: "香烟品牌", cigsLabel: "每天香烟数量", yearLabel: "开始年份", calcButton: "计算", resultsTitle: "结果", spentText: "总花费在香烟上", btcText: "积累的 BTC", valueText: "当前价值", gainText: "净收益", motivation: "想象你可以用这些钱做什么！今天戒烟，过上更健康、更富有的生活。", shareButton: "在 X 上分享", disclaimer: "免责声明：基于历史数据（WHO、Statista、CoinGecko）的模拟。BTC 投资有风险，过去表现不保证未来结果。请咨询专业人士。" },
            ja: { hook: "ビットコインはあなたの命と財務を救えるか？", title: "お金と健康を救え", brandLabel: "タバコのブランド", cigsLabel: "1日のタバコ本数", yearLabel: "開始年", calcButton: "計算", resultsTitle: "結果", spentText: "タバコに費やした合計", btcText: "蓄積された BTC", valueText: "現在の価値", gainText: "純利益", motivation: "そのお金で何ができるか想像してみてください！今日禁煙して、より健康的で豊かな生活を。", shareButton: "X で共有", disclaimer: "免責事項：歴史データ（WHO、Statista、CoinGecko）に基づくシミュレーション。BTC 投資はリスクがあり、過去の実績は将来の結果を保証しません。専門家に相談してください。" }
        };

        // Données cigarettes (USD, paquet de 20, sources : OMS, Statista, Numbeo, Euromonitor)
        const countryPrices = {
            FR: {2009: 6.5, 2010: 7.0, 2011: 7.3, 2012: 7.6, 2013: 8.0, 2014: 8.5, 2015: 8.5, 2016: 8.5, 2017: 8.6, 2018: 9.5, 2019: 10.5, 2020: 11.9, 2021: 12.5, 2022: 12.5, 2023: 13.0, 2024: 13.7, 2025: 14.3},
            US: {2009: 5.0, 2010: 5.5, 2011: 6.0, 2012: 6.2, 2013: 6.5, 2014: 6.8, 2015: 7.0, 2016: 7.2, 2017: 7.4, 2018: 7.6, 2019: 7.4, 2020: 8.0, 2021: 8.0, 2022: 8.5, 2023: 9.0, 2024: 9.5, 2025: 10.0},
            ES: {2009: 4.0, 2010: 4.2, 2011: 4.5, 2012: 4.7, 2013: 5.0, 2014: 5.2, 2015: 5.3, 2016: 5.4, 2017: 5.5, 2018: 5.6, 2019: 5.8, 2020: 6.0, 2021: 6.0, 2022: 6.0, 2023: 6.2, 2024: 6.3, 2025: 6.4},
            RU: {2009: 1.0, 2010: 1.5, 2011: 1.8, 2012: 2.0, 2013: 2.2, 2014: 2.3, 2015: 2.4, 2016: 2.5, 2017: 2.6, 2018: 2.7, 2019: 2.8, 2020: 2.9, 2021: 3.0, 2022: 3.0, 2023: 3.0, 2024: 3.1, 2025: 3.1},
            CN: {2009: 1.5, 2010: 1.6, 2011: 1.7, 2012: 1.8, 2013: 1.9, 2014: 2.0, 2015: 2.1, 2016: 2.2, 2017: 2.3, 2018: 2.4, 2019: 2.5, 2020: 2.6, 2021: 2.7, 2022: 2.8, 2023: 3.0, 2024: 3.3, 2025: 3.5},
            JP: {2009: 3.0, 2010: 3.2, 2011: 3.4, 2012: 3.5, 2013: 3.6, 2014: 3.7, 2015: 3.8, 2016: 3.9, 2017: 4.0, 2018: 4.0, 2019: 4.1, 2020: 4.2, 2021: 4.3, 2022: 4.3, 2023: 4.4, 2024: 4.5, 2025: 4.0}
        };

        // Prix BTC hebdomadaires moyens (USD, approximés pour prototype)
        const btcWeeklyPrices = {
            2009: Array(52).fill(0.0001),
            2010: Array(52).fill(0.05),
            2011: Array(52).fill(5),
            2012: Array(52).fill(8),
            2013: Array(52).fill(200),
            2014: Array(52).fill(500),
            2015: Array(52).fill(300),
            2016: Array(52).fill(600),
            2017: Array(52).fill(4000),
            2018: Array(52).fill(7000),
            2019: Array(52).fill(7000),
            2020: Array(52).fill(11000),
            2021: Array(52).fill(47000),
            2022: Array(52).fill(28000),
            2023: Array(52).fill(26000),
            2024: Array(52).fill(50000),
            2025: Array(42).fill(92000) // Jusqu'à 15 oct 2025
        };

        const currentBtcPrice = 92000; // À actualiser via API CoinGecko

        const brandAdjust = { average: 1, marlboro: 1.05, camel: 0.98, gauloises: 0.95 };
        
        let country = 'US';
        let lang = 'en';

        // Détection pays
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                pos => {
                    fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${pos.coords.latitude}&longitude=${pos.coords.longitude}&localityLanguage=en`)
                        .then(res => res.json())
                        .then(data => {
                            country = data.countryCode || 'US';
                            lang = { FR: 'fr', US: 'en', ES: 'es', RU: 'ru', CN: 'zh', JP: 'ja' }[country] || 'en';
                            applyTranslation(lang);
                        })
                        .catch(() => applyTranslation('en'));
                },
                () => applyTranslation('en')
            );
        } else {
            applyTranslation('en');
        }

        function applyTranslation(l) {
            const t = translations[l];
            document.getElementById('hook').textContent = t.hook;
            document.getElementById('title').textContent = t.title;
            document.getElementById('brandLabel').textContent = t.brandLabel;
            document.getElementById('cigsLabel').textContent = t.cigsLabel;
            document.getElementById('yearLabel').textContent = t.yearLabel;
            document.getElementById('calcButton').innerHTML = '<i class="fas fa-calculator"></i> ' + t.calcButton;
            document.getElementById('resultsTitle').textContent = t.resultsTitle;
            document.getElementById('spentText').firstChild.textContent = t.spentText + ': ';
            document.getElementById('btcText').firstChild.textContent = t.btcText + ': ';
            document.getElementById('valueText').firstChild.textContent = t.valueText + ': ';
            document.getElementById('gainText').firstChild.textContent = t.gainText + ': ';
            document.getElementById('motivation').textContent = t.motivation;
            document.getElementById('shareButton').innerHTML = '<i class="fab fa-x-twitter"></i> ' + t.shareButton;
            document.getElementById('disclaimer').textContent = t.disclaimer;
        }

        let chart = null;

        function formatNumber(num) {
            if (num >= 1000000) return `<span class="million">${(num / 1000000).toFixed(3)} M USD</span>`;
            return `${num.toFixed(0)} USD`;
        }

        function calculate() {
            document.getElementById('loader').style.display = 'block';
            document.getElementById('result').style.display = 'none';

            setTimeout(() => {
                const brand = document.getElementById('brand').value;
                const cigsPerDay = parseInt(document.getElementById('cigsPerDay').value) || 20;
                const startYear = parseInt(document.getElementById('startYear').value) || 2009;
                const currentYear = 2025;
                const currentWeek = 42; // 15 oct 2025 ~ semaine 42
                
                let totalSpent = 0;
                let totalBtc = 0;
                let yearlyData = { years: [], spent: [], btcValue: [] };
                
                for (let year = Math.max(startYear, 2009); year <= currentYear; year++) {
                    if (!countryPrices[country][year]) {
                        console.warn(`Prix cigarettes manquant pour ${country} en ${year}, utilisation du prix de ${currentYear}`);
                    }
                    const cigPrice = (countryPrices[country][year] || countryPrices[country][currentYear]) * brandAdjust[brand];
                    const weeks = (year === currentYear) ? currentWeek : 52;
                    const packsPerWeek = (cigsPerDay / 20) * 7;
                    const costWeek = packsPerWeek * cigPrice;
                    
                    if (!btcWeeklyPrices[year]) {
                        console.warn(`Prix BTC manquant pour ${year}, utilisation du prix actuel`);
                    }
                    const btcWeek = btcWeeklyPrices[year] ? btcWeeklyPrices[year][0] : currentBtcPrice;
                    
                    for (let week = 1; week <= weeks; week++) {
                        totalSpent += costWeek;
                        totalBtc += costWeek / btcWeek;
                    }
                    
                    yearlyData.years.push(year);
                    yearlyData.spent.push(totalSpent);
                    yearlyData.btcValue.push(totalBtc * currentBtcPrice);
                }
                
                const currentValue = totalBtc * currentBtcPrice;
                const gain = currentValue - totalSpent;
                
                document.getElementById('totalSpent').innerHTML = formatNumber(totalSpent);
                document.getElementById('totalBtc').textContent = totalBtc.toFixed(4);
                document.getElementById('currentValue').innerHTML = formatNumber(currentValue);
                document.getElementById('gain').innerHTML = formatNumber(gain);
                
                document.getElementById('loader').style.display = 'none';
                document.getElementById('result').style.display = 'block';
                
                if (chart) chart.destroy();
                const ctx = document.getElementById('evolutionChart').getContext('2d');
                chart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: yearlyData.years,
                        datasets: [
                            { label: translations[lang].spentText, data: yearlyData.spent, borderColor: '#dc3545', fill: false },
                            { label: translations[lang].valueText, data: yearlyData.btcValue, borderColor: '#198754', fill: false }
                        ]
                    },
                    options: { responsive: true, scales: { y: { beginAtZero: true } } }
                });
            }, 500); // Simule chargement
        }

        function shareOnX() {
            const gain = document.getElementById('gain').innerHTML;
            const text = encodeURIComponent(`${translations[lang].motivation} ${translations[lang].gainText}: ${gain} #StopSmoking #Bitcoin [insérer lien site]`);
            window.open(`https://twitter.com/intent/tweet?text=${text}`, '_blank');
        }
    </script>
</body>
</html>
